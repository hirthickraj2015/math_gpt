Dataset Statistics:
  Training set size: 4,270,510 characters
  Testing set size: 474,214 characters
  Training examples: 333,727
  Testing examples: 37,080

Sample expressions from training set:
  5*1+6-4=7
  372%21=15
  ((((10-6)-2)-1)-8)=-7
  21+25+2=48
  (9-4)*(3-0)=15
  7-(19//50)=7
  (11+26)-11=26
  78-31=47
  14%41*40=560
  28+(5*19)=123
Vocabulary:
  Size: 19
  Characters:
 % ( ) * + - / 0 1 2 3 4 5 6 7 8 9 =

Example encoding:
  Original: 5+3=8
  Encoded: [13, 5, 11, 18, 16]
  Decoded: 5+3=8
Encoded datasets:
  Train tensor shape: torch.Size([4270510])
  Test tensor shape: torch.Size([474214])

Model Architecture:
  Total parameters: 800,787 (0.80M)
  Vocabulary size: 19
  Embedding dimension: 128
  Number of layers: 4
  Number of heads: 4

Model loaded on: mps
Starting training...
Total iterations: 20000
Evaluation interval: 500
------------------------------------------------------------
Evaluating accuracy at iteration 0...
Iter     0 | Train loss: 2.9884 | Test loss: 2.9882 | Accuracy: 0.0% | Digit Acc: 0.9% | Time: 32.9s
  New best model saved! (test loss: 2.9882)
Evaluating accuracy at iteration 500...
Iter   500 | Train loss: 1.7974 | Test loss: 1.8011 | Accuracy: 3.0% | Digit Acc: 16.4% | Time: 81.3s
Evaluating accuracy at iteration 1000...
Iter  1000 | Train loss: 1.7572 | Test loss: 1.7559 | Accuracy: 5.0% | Digit Acc: 17.6% | Time: 121.4s
  New best model saved! (test loss: 1.7559)
Evaluating accuracy at iteration 1500...
Iter  1500 | Train loss: 1.7359 | Test loss: 1.7369 | Accuracy: 4.0% | Digit Acc: 18.8% | Time: 160.4s
Evaluating accuracy at iteration 2000...
Iter  2000 | Train loss: 1.7185 | Test loss: 1.7199 | Accuracy: 6.0% | Digit Acc: 15.8% | Time: 199.5s
  New best model saved! (test loss: 1.7199)
Evaluating accuracy at iteration 2500...
Iter  2500 | Train loss: 1.7084 | Test loss: 1.7081 | Accuracy: 5.0% | Digit Acc: 17.8% | Time: 238.6s
Evaluating accuracy at iteration 3000...
Iter  3000 | Train loss: 1.6892 | Test loss: 1.6917 | Accuracy: 4.0% | Digit Acc: 20.8% | Time: 277.0s
  New best model saved! (test loss: 1.6917)
Evaluating accuracy at iteration 3500...
Iter  3500 | Train loss: 1.6787 | Test loss: 1.6821 | Accuracy: 5.0% | Digit Acc: 24.1% | Time: 315.5s
Evaluating accuracy at iteration 4000...
Iter  4000 | Train loss: 1.6712 | Test loss: 1.6718 | Accuracy: 5.0% | Digit Acc: 23.8% | Time: 358.1s
  New best model saved! (test loss: 1.6718)
Evaluating accuracy at iteration 4500...
Iter  4500 | Train loss: 1.6558 | Test loss: 1.6608 | Accuracy: 6.0% | Digit Acc: 20.9% | Time: 396.9s
Evaluating accuracy at iteration 5000...
Iter  5000 | Train loss: 1.6416 | Test loss: 1.6446 | Accuracy: 9.0% | Digit Acc: 24.9% | Time: 435.3s
  New best model saved! (test loss: 1.6446)
Evaluating accuracy at iteration 5500...
Iter  5500 | Train loss: 1.6352 | Test loss: 1.6382 | Accuracy: 8.0% | Digit Acc: 24.4% | Time: 473.8s
Evaluating accuracy at iteration 6000...
Iter  6000 | Train loss: 1.6245 | Test loss: 1.6235 | Accuracy: 8.0% | Digit Acc: 28.4% | Time: 511.8s
  New best model saved! (test loss: 1.6235)
Evaluating accuracy at iteration 6500...
Iter  6500 | Train loss: 1.6213 | Test loss: 1.6228 | Accuracy: 8.0% | Digit Acc: 28.1% | Time: 549.9s
Evaluating accuracy at iteration 7000...
Iter  7000 | Train loss: 1.6101 | Test loss: 1.6127 | Accuracy: 9.0% | Digit Acc: 30.8% | Time: 587.6s
  New best model saved! (test loss: 1.6127)
Evaluating accuracy at iteration 7500...
Iter  7500 | Train loss: 1.6084 | Test loss: 1.6106 | Accuracy: 9.0% | Digit Acc: 28.1% | Time: 625.5s
Evaluating accuracy at iteration 8000...
Iter  8000 | Train loss: 1.5955 | Test loss: 1.6012 | Accuracy: 14.0% | Digit Acc: 33.2% | Time: 663.5s
  New best model saved! (test loss: 1.6012)
Evaluating accuracy at iteration 8500...
Iter  8500 | Train loss: 1.5880 | Test loss: 1.5923 | Accuracy: 16.0% | Digit Acc: 36.8% | Time: 701.4s
Evaluating accuracy at iteration 9000...
Iter  9000 | Train loss: 1.5863 | Test loss: 1.5881 | Accuracy: 7.0% | Digit Acc: 32.2% | Time: 739.3s
  New best model saved! (test loss: 1.5881)
Evaluating accuracy at iteration 9500...
Iter  9500 | Train loss: 1.5781 | Test loss: 1.5835 | Accuracy: 13.0% | Digit Acc: 33.8% | Time: 777.1s
Evaluating accuracy at iteration 10000...
Iter 10000 | Train loss: 1.5721 | Test loss: 1.5748 | Accuracy: 14.0% | Digit Acc: 40.3% | Time: 815.1s
  New best model saved! (test loss: 1.5748)
Evaluating accuracy at iteration 10500...
Iter 10500 | Train loss: 1.5675 | Test loss: 1.5703 | Accuracy: 13.0% | Digit Acc: 39.8% | Time: 853.0s
Evaluating accuracy at iteration 11000...
Iter 11000 | Train loss: 1.5620 | Test loss: 1.5671 | Accuracy: 18.0% | Digit Acc: 41.4% | Time: 890.6s
  New best model saved! (test loss: 1.5671)
Evaluating accuracy at iteration 11500...
Iter 11500 | Train loss: 1.5543 | Test loss: 1.5611 | Accuracy: 17.0% | Digit Acc: 40.6% | Time: 928.8s
Evaluating accuracy at iteration 12000...
Iter 12000 | Train loss: 1.5519 | Test loss: 1.5578 | Accuracy: 17.0% | Digit Acc: 40.7% | Time: 966.5s
  New best model saved! (test loss: 1.5578)
Evaluating accuracy at iteration 12500...
Iter 12500 | Train loss: 1.5499 | Test loss: 1.5564 | Accuracy: 19.0% | Digit Acc: 43.3% | Time: 1002.3s
Evaluating accuracy at iteration 13000...
Iter 13000 | Train loss: 1.5460 | Test loss: 1.5498 | Accuracy: 19.0% | Digit Acc: 42.5% | Time: 1038.0s
  New best model saved! (test loss: 1.5498)
Evaluating accuracy at iteration 13500...
Iter 13500 | Train loss: 1.5422 | Test loss: 1.5487 | Accuracy: 16.0% | Digit Acc: 42.9% | Time: 1073.9s
Evaluating accuracy at iteration 14000...
Iter 14000 | Train loss: 1.5407 | Test loss: 1.5433 | Accuracy: 20.0% | Digit Acc: 42.1% | Time: 1109.5s
  New best model saved! (test loss: 1.5433)
Evaluating accuracy at iteration 14500...
Iter 14500 | Train loss: 1.5346 | Test loss: 1.5383 | Accuracy: 22.0% | Digit Acc: 42.6% | Time: 1145.5s
Evaluating accuracy at iteration 15000...
Iter 15000 | Train loss: 1.5313 | Test loss: 1.5384 | Accuracy: 26.0% | Digit Acc: 45.5% | Time: 1181.8s
Evaluating accuracy at iteration 15500...
Iter 15500 | Train loss: 1.5306 | Test loss: 1.5352 | Accuracy: 16.0% | Digit Acc: 41.9% | Time: 1217.6s
Evaluating accuracy at iteration 16000...
Iter 16000 | Train loss: 1.5273 | Test loss: 1.5320 | Accuracy: 21.0% | Digit Acc: 47.0% | Time: 1253.3s
  New best model saved! (test loss: 1.5320)
Evaluating accuracy at iteration 16500...
Iter 16500 | Train loss: 1.5232 | Test loss: 1.5312 | Accuracy: 23.0% | Digit Acc: 49.2% | Time: 1289.5s
Evaluating accuracy at iteration 17000...
Iter 17000 | Train loss: 1.5257 | Test loss: 1.5268 | Accuracy: 24.0% | Digit Acc: 48.2% | Time: 1325.9s
  New best model saved! (test loss: 1.5268)
Evaluating accuracy at iteration 17500...
Iter 17500 | Train loss: 1.5199 | Test loss: 1.5242 | Accuracy: 23.0% | Digit Acc: 50.0% | Time: 1362.3s
Evaluating accuracy at iteration 18000...
Iter 18000 | Train loss: 1.5181 | Test loss: 1.5226 | Accuracy: 28.0% | Digit Acc: 49.2% | Time: 1398.1s
  New best model saved! (test loss: 1.5226)
Evaluating accuracy at iteration 18500...
Iter 18500 | Train loss: 1.5158 | Test loss: 1.5224 | Accuracy: 20.0% | Digit Acc: 46.1% | Time: 1434.1s
Evaluating accuracy at iteration 19000...
Iter 19000 | Train loss: 1.5196 | Test loss: 1.5245 | Accuracy: 23.0% | Digit Acc: 48.4% | Time: 1470.2s
Evaluating accuracy at iteration 19500...
Iter 19500 | Train loss: 1.5206 | Test loss: 1.5219 | Accuracy: 26.0% | Digit Acc: 48.0% | Time: 1506.7s
Evaluating accuracy at iteration 19999...
Iter 19999 | Train loss: 1.5187 | Test loss: 1.5248 | Accuracy: 22.0% | Digit Acc: 44.1% | Time: 1542.7s
------------------------------------------------------------
Training complete!
Best test loss: 1.5219
Final train loss: 1.5187
Final test loss: 1.5248
Total training time: 1542.8s
Model saved as: model_weights_part1.pth

To load this model:
  model = GPTLanguageModel()
  model.load_state_dict(torch.load('model_weights_part1.pth'))
  model.eval()
